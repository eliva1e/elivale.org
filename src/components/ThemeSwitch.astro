---
import MoonIcon from "./icons/MoonIcon.astro";
import SunIcon from "./icons/SunIcon.astro";
---

<button id="theme-toggle">
    <MoonIcon class="moon" />
    <SunIcon class="sun" />
</button>

<style>
    #theme-toggle {
        cursor: pointer;
        display: flex;
    }

    .moon {
        color: black;
    }

    .sun {
        background-color: black;
    }
</style>

<script>
    let theme = "dark";
    const localStorageTheme = localStorage.getItem("theme");

    if (localStorageTheme) {
        if (["dark", "light"].includes(localStorageTheme)) {
            theme = localStorageTheme;
        }
    } else {
        theme = window.matchMedia("(prefers-color-scheme: dark)").matches
            ? "dark"
            : "light";
    }

    if (theme === "dark") {
        document.documentElement.classList.add("dark");
    } else {
        document.documentElement.classList.remove("dark");
    }

    const handleToggleClick = () => {
        console.log("geq");
        const element = document.documentElement;
        element.classList.toggle("dark");

        const isDark = element.classList.contains("dark");
        localStorage.setItem("theme", isDark ? "dark" : "light");
    };

    document
        .getElementById("theme-toggle")
        ?.addEventListener("click", handleToggleClick);
</script>
